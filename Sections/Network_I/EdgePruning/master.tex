\chapter{Selective edge pruning} \label{s:N_I:sel_pruning}
\vspace{3mm}
\fbox{
    \parbox{0.95\linewidth}{
      \begin{itemize}
        \item Finding the minimum degree for Transcription Factors (TFs)
        \item A subset of 98 genes TFs are highly connected in the network
        \item Basal group with the lowest survival rate
        \item SBM performs better when more edges are allowed in a graph
      \end{itemize}
    }
}
\vspace{3mm}

\section{Introduction}

% The aim to integrate the TF
In the previous section it was noticed that the weight modifiers and selective edge pruning have an effect to the graphs, community detection algorithms and to the MIBC subtype. This part of the project aims to find the appropriate configuration for the selective edge pruning as well as understanding their effects on the community detection methods. 

The objective is prioritising the \acrfull{tf} over the standard genes as these up-regulated the expression of the other genes leading to higher biological influence. By allowing more connections for the TF, the minimum degree of the node increases as well as their role in the network, similar to the biology. The work in this section was presented as a poster at the \textit{\href{https://2023.complexnetworks.org/}{Complex Network Conference in 2023}}.

% The aim to find the better community detection
An objective adopted for this section therefore was to compare the Leiden \citep{Traag2019-ne} community detection used in PGCNA with the degree corrected Stochastic Block Model (DC-SBM) from \citep{Karrer2011-si, Peixoto2017-gc}. As it was covered in \cref{s:lit:comm_detect} from Background, Leiden is faster and more popular, but it is prone to find patterns in noise, whereas the DC-SBM is slower but it is more error proof to find non-existent communities; the differences between the two methods are covered in more detail in \cref{s:lit:comm_detect}. 

The chapter begins by analysing the differences between the SBM and Leiden algorithms and how they respond to various configurations of selective edge pruning. During this comparison, a subset of 98 TFs was identified as consistently highly connected, even in the control experiments. This subset of genes is further analysed and explored in \cref{s:N_I:sel_tfs} within the context of both tumour and non-tumour datasets. The analysis is then expanded in \cref{s:N_I:sel_tfs_bio}, where \acrfull{dea} is applied to the MIBC subtypes derived using the expression of these 98 genes.

% The expression of this subset of gene is analysed in the context of both the non-tumour and tumour datasets and used to stratify the MIBC cohort from TCGA. Survival analysis and \acrfull{dea} is then used to further understand these subgroups with a focus on the basal samples with the poorest survival.

% Throughout the project the degree corrected (DC-SBM) \& hierarchical (hSBM) stochastic block models were preferred over the simple SBM \citep{Holland1983-eu} as it accounts for the node degree when it finds the communities, which is crucial for selective edge pruning; for convenience DC-SBM and SBM are used interchangeably.

% Mention that there are 98 TFs


% 
% Through the experiments performed in this project and the analysis in the PGCNA work \citep{Care2019-ij} it was noticed that if a node has too many edges, the network becomes very dense and more complicated to analyse. Conversely, if a node has a few edges ($<3$), then the community detection (Leiden \cite{Traag2019-ne}) finds disconnected community. \citet{Care2019-ij} (empirically) found that the appropriate number of edges for a node is 3, and it is the value used throughout the project for the non-transcription factor gene (or 'standard'). 

\section{Aims}

This part of the project aims to:
\begin{itemize}
    \item Find the minimum degree for TFs
    \item Understand the biological role of the 98 TFs which are constantly connected
    \item Investigate the subgroups derived from the expression of the 98 genes
\end{itemize}


\import{Sections/Network_I/EdgePruning}{methods.tex}

\import{Sections/Network_I/EdgePruning}{com_detection_comp.tex}

\import{Sections/Network_I/EdgePruning}{results.tex}

\import{Sections/Network_I/EdgePruning}{dea.tex}


% Summary
\subsection{Summary}

% Recapitulate the aims and what have been done
This subsection began with two aims: identifying the appropriate community detection method and exploring the integration of Transcription Factors (TF) into the network. The comparison at the start of the section (\ref{s:N_I:sel_tf_com_det}) demonstrated that, despite the high computational cost of Stochastic Block Models (SBM), they offer more advantages over Modularity Maximisation algorithms such as Leiden. From a network perspective, the selective edge pruning method to integrating TFs is effective, as those nodes exhibited a higher degree. Therefore, the two aims of were achieved.

% Significance in cancer
Throughout the selective edge experiments, it was remarkable to find that by using controls and prioritising non-TFs, a subset of 'naturally' well-connected TFs in the tumour dataset could be derived. The analysis in this section indicates that the subset of 98 TFs has important biological significance. Hierarchical clustering was applied to this subset of genes, yielding subtypes with significantly different survival outcomes (\cref{fig:N_I:sel_tfs_cs_analysis}).  From the five newly found groups the basal 5 has the lowest survival with squamous markers and the basal 3 resembles the mesenchymal group from Lund cohort.

While the subset of TFs was informative for the Basal subgroup, it was less successful for the luminal subgroup. The previously derived luminal subtypes (consensus, TCGA, Lund, and the work in the previous chapter) are grouped into one large group. Looking at a known luminal marker, \textit{FGFR3}, it was observed that this gene has a low degree in the network. In addition, some other known markers were left out in the gene selection process (e.g., \textit{PPARG}). This may also be explained by the fact that luminal tumours are "molecularly closer" to differentiated bladder tissue, compared to the basal subtypes which are undifferentiated urothelium. The high variance introduced by the basal subtype might explain why other known gene markers were missed.

\section{Discussion}

% Main results
Selective edge pruning has proven to be more than just a technique for integrating additional data into the network; it is also a novel method for identifying highly correlated genes in gene expression data. By combining experiments with controls (random genes), selective edge pruning, along with ModCon, successfully extracted 98 TFs (out of the 325 in the 5000-node network), which were then further analysed. Analysis of this subset of genes revealed five distinct MIBC groups, including three basal subtypes, a large luminal group, and a luminal-infiltrated group.

% Gene expression
The analysis of the 98 TFs identified a basal group (Basal 5) consisting of 20 patients with less than a 20\% chance of survival after 1.7 years (20 months), representing one of the poorest prognoses observed in the project. This group exhibited squamous markers, had a low immune response, and 7 out of the 10 most significantly expressed genes had previously been studied in cancer. Some of these 7 genes are associated with the aggressiveness of the tumours, while others could be targeted to improve treatment response.

% Other groups
Another subgroup, Basal 3, consisting of 30 samples, was identified, which included tumours previously classified as Mes-like by the Lund classifier \citep{Marzouka2018-ge}. \textbf{Both Basal 3 and Basal 5 exhibit similar survival prognoses, although Basal 3 has a more favourable outlook than Basal 5}.The significance of identifying a subtype similar to the Mes-like group from the Lund classifier lies in the fact that only the gene expression of the 98 TFs was used, without the \acrlong{ihc} data employed in the Lund cohort. This underscores the critical influence of the TF subset on bladder tumours.



% New markers
\subsubsection*{Potential new markers}

% the two lists of basal/luminal
Using the analysis performed on the non-tumour dataset and the gene expression data from TCGA, the 98 TF genes were reduced to two different lists of markers for basal and luminal subtypes (\cref{tab:N_I:genes_lum_basal}). Many genes from these two lists were validated by other research work, which strengthened the selective edge pruning as a method for extracting highly connected genes.

% the list for non-tumour data
Extending the findings beyond cancer, some of the 98 TF genes were classified by their expression in the non-tumour dataset. The analysis performed (\cref{s:N:sel_tf_diff_status}) proposes three lists of genes specific to P0, UD, and AbsCa, as well as another three between these categories. This refined list of genes may help biologists better understand urothelium differentiation, which in turn will also aid in elucidating the basal/luminal molecular differences.


% Comm detection
\subsubsection*{Community detection}

Varying the number of edges per TF significantly impacts the community detection algorithms, Leiden more than SBM. It was observed that the former finds fewer communities as the nodes' degree is increased, while SBM is more stable. This, along with the work from \citet{Peixoto2021-jx, Peixoto2023-rt}, which shows that Modularity Maximisation methods are prone to finding patterns in noise, made SBM the preferred method in this project. In this chapter, the simple degree-corrected version of SBM was used, but a hierarchical version of it will be used in the next chapter. The hierarchical SBM is more complex and computationally expensive than the standard version, but it does not have a threshold on the number of communities it can find; limit discussed in \cref{s:lit:sbm}.


% Further work
Considering the limitations, the analysis performed suggests that both the subset of 98 TFs and the subtypes need more in-depth exploration, even selecting a few targeted genes to study the bladder response \textit{in-vitro}. It also suggests that the selective edge pruning is working and exhibits highly relevant biological results.

\subsection* {Limitations}

One of the limitations of the work done in selective edge pruning was that only ten control networks were used for comparison. This was due to the high computational time (a few hours) required to run the SBM, the lengthy process of loading the network output\footnote{During the network runs and SBM, a lot of metadata was saved, which helped to debug, understand, and analyse the networks. This made the network output fairly large, taking a considerable footprint of the RAM. For example, analysing the results for the 10 controls and experiments takes approximately 40GB of RAM.} and the limited time in a PhD project. Another possible limitation is using only 5000 genes for a network using SBM. As it will be seen in the next chapter \cref{s:N_II}, the stochastic model is capable of finding smaller communities in a large network. This means that more genes can be included, but this will make the network very dense, so extra rules for edge pruning might be needed. However, from a biological perspective, re-running the selective edge pruning on larger networks and more controls may further enforce that there is a subset of TFs that are co-expressed with many genes in bladder cancer.


This and the previous chapter explored three types of data integration in a graph: at a network level, edge weights, and the number of connections. The first two strategies need further refining, while for the selective edge pruning, a minimum degree of 6 for TFs and 3 for standard genes was found to be appropriate. The subsequent section will consider the following changes:  q) utilising the entire non-tumour dataset to enhance gene representation in the tumour network; 3) using a hierarchical stochastic block model; and 4) improving the strategies for weight modifiers.


\subsection*{Novelty summary}

The following novel work was presented in this chapter:
\begin{itemize}
    \item Selective edge pruning as a method to find highly correlated genes
    \item 98 TFs which drive a three way basal split
    \item One of the lowest basal survival groups - including samples that were previously classified as Ba/Sq and not Ne
    \item Selective edge pruning integrated the TFs into a network a
\end{itemize}